# Docker

## 安装docker

```shell
[root@node1 ~]# yum install -y yum-utils 
Loaded plugins: fastestmirror
base                                          | 3.6 kB     00:00     
epel                                          | 4.3 kB     00:00     
extras                                        | 2.9 kB     00:00     
updates                                       | 2.9 kB     00:00     
Loading mirror speeds from cached hostfile
Resolving Dependencies
--> Running transaction check
---> Package yum-utils.noarch 0:1.1.31-54.el7_8 will be installed
--> Processing Dependency: python-kitchen for package: yum-utils-1.1.31-54.el7_8.noarch
--> Processing Dependency: libxml2-python for package: yum-utils-1.1.31-54.el7_8.noarch
--> Running transaction check
---> Package libxml2-python.x86_64 0:2.9.1-6.el7_9.6 will be installed
--> Processing Dependency: libxml2 = 2.9.1-6.el7_9.6 for package: libxml2-python-2.9.1-6.el7_9.6.x86_64
---> Package python-kitchen.noarch 0:1.1.1-5.el7 will be installed
--> Processing Dependency: python-chardet for package: python-kitchen-1.1.1-5.el7.noarch
--> Running transaction check
---> Package libxml2.x86_64 0:2.9.1-6.el7_2.3 will be updated
---> Package libxml2.x86_64 0:2.9.1-6.el7_9.6 will be an update
---> Package python-chardet.noarch 0:2.2.1-3.el7 will be installed
--> Finished Dependency Resolution

Dependencies Resolved

=====================================================================
 Package            Arch       Version             Repository   Size
=====================================================================
Installing:
 yum-utils          noarch     1.1.31-54.el7_8     base        122 k
Installing for dependencies:
 libxml2-python     x86_64     2.9.1-6.el7_9.6     updates     247 k
 python-chardet     noarch     2.2.1-3.el7         base        227 k
 python-kitchen     noarch     1.1.1-5.el7         base        267 k
Updating for dependencies:
 libxml2            x86_64     2.9.1-6.el7_9.6     updates     668 k

Transaction Summary
=====================================================================
Install  1 Package  (+3 Dependent packages)
Upgrade             ( 1 Dependent package)

Total download size: 1.5 M
Downloading packages:
Delta RPMs disabled because /usr/bin/applydeltarpm not installed.
(1/5): libxml2-2.9.1-6.el7_9.6.x86_64.rpm       | 668 kB   00:00     
(2/5): libxml2-python-2.9.1-6.el7_9.6.x86_64.rp | 247 kB   00:00     
(3/5): python-chardet-2.2.1-3.el7.noarch.rpm    | 227 kB   00:00     
(4/5): python-kitchen-1.1.1-5.el7.noarch.rpm    | 267 kB   00:00     
(5/5): yum-utils-1.1.31-54.el7_8.noarch.rpm     | 122 kB   00:00     
---------------------------------------------------------------------
Total                                   1.5 MB/s | 1.5 MB  00:00     
Running transaction check
Running transaction test
Transaction test succeeded
Running transaction
  Updating   : libxml2-2.9.1-6.el7_9.6.x86_64                    1/6 
  Installing : libxml2-python-2.9.1-6.el7_9.6.x86_64             2/6 
  Installing : python-chardet-2.2.1-3.el7.noarch                 3/6 
  Installing : python-kitchen-1.1.1-5.el7.noarch                 4/6 
  Installing : yum-utils-1.1.31-54.el7_8.noarch                  5/6 
  Cleanup    : libxml2-2.9.1-6.el7_2.3.x86_64                    6/6 
  Verifying  : python-chardet-2.2.1-3.el7.noarch                 1/6 
  Verifying  : libxml2-2.9.1-6.el7_9.6.x86_64                    2/6 
  Verifying  : libxml2-python-2.9.1-6.el7_9.6.x86_64             3/6 
  Verifying  : python-kitchen-1.1.1-5.el7.noarch                 4/6 
  Verifying  : yum-utils-1.1.31-54.el7_8.noarch                  5/6 
  Verifying  : libxml2-2.9.1-6.el7_2.3.x86_64                    6/6 

Installed:
  yum-utils.noarch 0:1.1.31-54.el7_8                                 

Dependency Installed:
  libxml2-python.x86_64 0:2.9.1-6.el7_9.6                            
  python-chardet.noarch 0:2.2.1-3.el7                                
  python-kitchen.noarch 0:1.1.1-5.el7                                

Dependency Updated:
  libxml2.x86_64 0:2.9.1-6.el7_9.6                                   

Complete!
[root@node1 ~]# yum-config-manager --add-repo https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo 
Loaded plugins: fastestmirror
adding repo from: https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo
grabbing file https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo to /etc/yum.repos.d/docker-ce.repo
repo saved to /etc/yum.repos.d/docker-ce.repo
[root@node1 ~]# yum install docker-ce
Loaded plugins: fastestmirror
docker-ce-stable                              | 3.5 kB     00:00     
(1/2): docker-ce-stable/7/x86_64/updateinfo     |   55 B   00:00     
(2/2): docker-ce-stable/7/x86_64/primary_db     | 152 kB   00:00     
Loading mirror speeds from cached hostfile
Resolving Dependencies
--> Running transaction check
---> Package docker-ce.x86_64 3:26.1.4-1.el7 will be installed
--> Processing Dependency: container-selinux >= 2:2.74 for package: 3:docker-ce-26.1.4-1.el7.x86_64
--> Processing Dependency: containerd.io >= 1.6.24 for package: 3:docker-ce-26.1.4-1.el7.x86_64
--> Processing Dependency: docker-ce-cli for package: 3:docker-ce-26.1.4-1.el7.x86_64
--> Processing Dependency: docker-ce-rootless-extras for package: 3:docker-ce-26.1.4-1.el7.x86_64
--> Processing Dependency: libcgroup for package: 3:docker-ce-26.1.4-1.el7.x86_64
--> Running transaction check
---> Package container-selinux.noarch 2:2.119.2-1.911c772.el7_8 will be installed
--> Processing Dependency: selinux-policy-targeted >= 3.13.1-216.el7 for package: 2:container-selinux-2.119.2-1.911c772.el7_8.noarch
--> Processing Dependency: selinux-policy-base >= 3.13.1-216.el7 for package: 2:container-selinux-2.119.2-1.911c772.el7_8.noarch
--> Processing Dependency: selinux-policy >= 3.13.1-216.el7 for package: 2:container-selinux-2.119.2-1.911c772.el7_8.noarch
--> Processing Dependency: policycoreutils-python for package: 2:container-selinux-2.119.2-1.911c772.el7_8.noarch
---> Package containerd.io.x86_64 0:1.6.33-3.1.el7 will be installed
---> Package docker-ce-cli.x86_64 1:26.1.4-1.el7 will be installed
--> Processing Dependency: docker-buildx-plugin for package: 1:docker-ce-cli-26.1.4-1.el7.x86_64
--> Processing Dependency: docker-compose-plugin for package: 1:docker-ce-cli-26.1.4-1.el7.x86_64
---> Package docker-ce-rootless-extras.x86_64 0:26.1.4-1.el7 will be installed
--> Processing Dependency: fuse-overlayfs >= 0.7 for package: docker-ce-rootless-extras-26.1.4-1.el7.x86_64
--> Processing Dependency: slirp4netns >= 0.4 for package: docker-ce-rootless-extras-26.1.4-1.el7.x86_64
---> Package libcgroup.x86_64 0:0.41-21.el7 will be installed
--> Running transaction check
---> Package docker-buildx-plugin.x86_64 0:0.14.1-1.el7 will be installed
---> Package docker-compose-plugin.x86_64 0:2.27.1-1.el7 will be installed
---> Package fuse-overlayfs.x86_64 0:0.7.2-6.el7_8 will be installed
--> Processing Dependency: libfuse3.so.3(FUSE_3.2)(64bit) for package: fuse-overlayfs-0.7.2-6.el7_8.x86_64
--> Processing Dependency: libfuse3.so.3(FUSE_3.0)(64bit) for package: fuse-overlayfs-0.7.2-6.el7_8.x86_64
--> Processing Dependency: libfuse3.so.3()(64bit) for package: fuse-overlayfs-0.7.2-6.el7_8.x86_64
---> Package policycoreutils-python.x86_64 0:2.5-34.el7 will be installed
--> Processing Dependency: policycoreutils = 2.5-34.el7 for package: policycoreutils-python-2.5-34.el7.x86_64
--> Processing Dependency: setools-libs >= 3.3.8-4 for package: policycoreutils-python-2.5-34.el7.x86_64
--> Processing Dependency: libsemanage-python >= 2.5-14 for package: policycoreutils-python-2.5-34.el7.x86_64
--> Processing Dependency: audit-libs-python >= 2.1.3-4 for package: policycoreutils-python-2.5-34.el7.x86_64
--> Processing Dependency: python-IPy for package: policycoreutils-python-2.5-34.el7.x86_64
--> Processing Dependency: libqpol.so.1(VERS_1.4)(64bit) for package: policycoreutils-python-2.5-34.el7.x86_64
--> Processing Dependency: libqpol.so.1(VERS_1.2)(64bit) for package: policycoreutils-python-2.5-34.el7.x86_64
--> Processing Dependency: libapol.so.4(VERS_4.0)(64bit) for package: policycoreutils-python-2.5-34.el7.x86_64
--> Processing Dependency: checkpolicy for package: policycoreutils-python-2.5-34.el7.x86_64
--> Processing Dependency: libqpol.so.1()(64bit) for package: policycoreutils-python-2.5-34.el7.x86_64
--> Processing Dependency: libapol.so.4()(64bit) for package: policycoreutils-python-2.5-34.el7.x86_64
---> Package selinux-policy.noarch 0:3.13.1-166.el7 will be updated
---> Package selinux-policy.noarch 0:3.13.1-268.el7_9.2 will be an update
--> Processing Dependency: libsemanage >= 2.5-13 for package: selinux-policy-3.13.1-268.el7_9.2.noarch
---> Package selinux-policy-targeted.noarch 0:3.13.1-166.el7 will be updated
---> Package selinux-policy-targeted.noarch 0:3.13.1-268.el7_9.2 will be an update
---> Package slirp4netns.x86_64 0:0.4.3-4.el7_8 will be installed
--> Running transaction check
---> Package audit-libs-python.x86_64 0:2.8.5-4.el7 will be installed
--> Processing Dependency: audit-libs(x86-64) = 2.8.5-4.el7 for package: audit-libs-python-2.8.5-4.el7.x86_64
---> Package checkpolicy.x86_64 0:2.5-8.el7 will be installed
---> Package fuse3-libs.x86_64 0:3.6.1-4.el7 will be installed
---> Package libsemanage.x86_64 0:2.5-8.el7 will be updated
---> Package libsemanage.x86_64 0:2.5-14.el7 will be an update
--> Processing Dependency: libsepol >= 2.5-10 for package: libsemanage-2.5-14.el7.x86_64
--> Processing Dependency: libselinux >= 2.5-14 for package: libsemanage-2.5-14.el7.x86_64
---> Package libsemanage-python.x86_64 0:2.5-14.el7 will be installed
---> Package policycoreutils.x86_64 0:2.5-17.1.el7 will be updated
---> Package policycoreutils.x86_64 0:2.5-34.el7 will be an update
--> Processing Dependency: libselinux-utils >= 2.5-14 for package: policycoreutils-2.5-34.el7.x86_64
---> Package python-IPy.noarch 0:0.75-6.el7 will be installed
---> Package setools-libs.x86_64 0:3.3.8-4.el7 will be installed
--> Running transaction check
---> Package audit-libs.x86_64 0:2.7.6-3.el7 will be updated
--> Processing Dependency: audit-libs(x86-64) = 2.7.6-3.el7 for package: audit-2.7.6-3.el7.x86_64
---> Package audit-libs.x86_64 0:2.8.5-4.el7 will be an update
---> Package libselinux.x86_64 0:2.5-11.el7 will be updated
--> Processing Dependency: libselinux(x86-64) = 2.5-11.el7 for package: libselinux-python-2.5-11.el7.x86_64
---> Package libselinux.x86_64 0:2.5-15.el7 will be an update
---> Package libselinux-utils.x86_64 0:2.5-11.el7 will be updated
---> Package libselinux-utils.x86_64 0:2.5-15.el7 will be an update
---> Package libsepol.x86_64 0:2.5-6.el7 will be updated
---> Package libsepol.x86_64 0:2.5-10.el7 will be an update
--> Running transaction check
---> Package audit.x86_64 0:2.7.6-3.el7 will be updated
---> Package audit.x86_64 0:2.8.5-4.el7 will be an update
---> Package libselinux-python.x86_64 0:2.5-11.el7 will be updated
---> Package libselinux-python.x86_64 0:2.5-15.el7 will be an update
--> Finished Dependency Resolution

Dependencies Resolved

=====================================================================
 Package                Arch   Version        Repository        Size
=====================================================================
Installing:
 docker-ce              x86_64 3:26.1.4-1.el7 docker-ce-stable  27 M
Installing for dependencies:
 audit-libs-python      x86_64 2.8.5-4.el7    base              76 k
 checkpolicy            x86_64 2.5-8.el7      base             295 k
 container-selinux      noarch 2:2.119.2-1.911c772.el7_8
                                              extras            40 k
 containerd.io          x86_64 1.6.33-3.1.el7 docker-ce-stable  35 M
 docker-buildx-plugin   x86_64 0.14.1-1.el7   docker-ce-stable  14 M
 docker-ce-cli          x86_64 1:26.1.4-1.el7 docker-ce-stable  15 M
 docker-ce-rootless-extras
                        x86_64 26.1.4-1.el7   docker-ce-stable 9.4 M
 docker-compose-plugin  x86_64 2.27.1-1.el7   docker-ce-stable  13 M
 fuse-overlayfs         x86_64 0.7.2-6.el7_8  extras            54 k
 fuse3-libs             x86_64 3.6.1-4.el7    extras            82 k
 libcgroup              x86_64 0.41-21.el7    base              66 k
 libsemanage-python     x86_64 2.5-14.el7     base             113 k
 policycoreutils-python x86_64 2.5-34.el7     base             457 k
 python-IPy             noarch 0.75-6.el7     base              32 k
 setools-libs           x86_64 3.3.8-4.el7    base             620 k
 slirp4netns            x86_64 0.4.3-4.el7_8  extras            81 k
Updating for dependencies:
 audit                  x86_64 2.8.5-4.el7    base             256 k
 audit-libs             x86_64 2.8.5-4.el7    base             102 k
 libselinux             x86_64 2.5-15.el7     base             162 k
 libselinux-python      x86_64 2.5-15.el7     base             236 k
 libselinux-utils       x86_64 2.5-15.el7     base             151 k
 libsemanage            x86_64 2.5-14.el7     base             151 k
 libsepol               x86_64 2.5-10.el7     base             297 k
 policycoreutils        x86_64 2.5-34.el7     base             917 k
 selinux-policy         noarch 3.13.1-268.el7_9.2
                                              updates          498 k
 selinux-policy-targeted
                        noarch 3.13.1-268.el7_9.2
                                              updates          7.0 M

Transaction Summary
=====================================================================
Install  1 Package  (+16 Dependent packages)
Upgrade             ( 10 Dependent packages)

Total download size: 125 M
Is this ok [y/d/N]: y
Downloading packages:
Delta RPMs disabled because /usr/bin/applydeltarpm not installed.
(1/27): audit-2.8.5-4.el7.x86_64.rpm            | 256 kB   00:00     
(2/27): audit-libs-2.8.5-4.el7.x86_64.rpm       | 102 kB   00:00     
(3/27): audit-libs-python-2.8.5-4.el7.x86_64.rp |  76 kB   00:00     
(4/27): checkpolicy-2.5-8.el7.x86_64.rpm        | 295 kB   00:00     
(5/27): container-selinux-2.119.2-1.911c772.el7 |  40 kB   00:00     
warning: /var/cache/yum/x86_64/7/docker-ce-stable/packages/docker-buildx-plugin-0.14.1-1.el7.x86_64.rpm: Header V4 RSA/SHA512 Signature, key ID 621e9f35: NOKEY
Public key for docker-buildx-plugin-0.14.1-1.el7.x86_64.rpm is not installed
(6/27): docker-buildx-plugin-0.14.1-1.el7.x86_6 |  14 MB   00:31     
(7/27): containerd.io-1.6.33-3.1.el7.x86_64.rpm |  35 MB   01:23     
(8/27): docker-ce-26.1.4-1.el7.x86_64.rpm       |  27 MB   01:07     
(9/27): docker-ce-cli-26.1.4-1.el7.x86_64.rpm   |  15 MB   00:35     
docker-compose-plugin-2.27.1-1 FAILED                                          
https://mirrors.aliyun.com/docker-ce/linux/centos/7/x86_64/stable/Packages/docker-compose-plugin-2.27.1-1.el7.x86_64.rpm: [Errno -1] Package does not match intended download. Suggestion: run yum --enablerepo=docker-ce-stable clean metadata
Trying other mirror.
(10/27): fuse-overlayfs-0.7.2-6.el7_8.x86_64.rp |  54 kB   00:00     
(11/27): libcgroup-0.41-21.el7.x86_64.rpm       |  66 kB   00:01     
(12/27): docker-ce-rootless-extras-26.1.4-1.el7 | 9.4 MB   00:21     
(13/27): fuse3-libs-3.6.1-4.el7.x86_64.rpm      |  82 kB   00:01     
(14/27): libselinux-python-2.5-15.el7.x86_64.rp | 236 kB   00:00     
(15/27): libselinux-2.5-15.el7.x86_64.rpm       | 162 kB   00:02     
(16/27): libselinux-utils-2.5-15.el7.x86_64.rpm | 151 kB   00:00     
(17/27): libsemanage-python-2.5-14.el7.x86_64.r | 113 kB   00:00     
(18/27): libsemanage-2.5-14.el7.x86_64.rpm      | 151 kB   00:00     
(19/27): libsepol-2.5-10.el7.x86_64.rpm         | 297 kB   00:00     
(20/27): policycoreutils-2.5-34.el7.x86_64.rpm  | 917 kB   00:01     
(21/27): python-IPy-0.75-6.el7.noarch.rpm       |  32 kB   00:00     
(22/27): slirp4netns-0.4.3-4.el7_8.x86_64.rpm   |  81 kB   00:01     
(23/27): selinux-policy-3.13.1-268.el7_9.2.noar | 498 kB   00:01     
(24/27): policycoreutils-python-2.5-34.el7.x86_ | 457 kB   00:03     
(25/27): setools-libs-3.3.8-4.el7.x86_64.rpm    | 620 kB   00:03     
(26/27): selinux-policy-targeted-3.13.1-268.el7 | 7.0 MB   00:10     


Error downloading packages:
  docker-compose-plugin-2.27.1-1.el7.x86_64: [Errno 256] No more mirrors to try.


[root@node1 ~]# yum install docker-compose-plugin-2.27.1-1.el7.x86_64
Loaded plugins: fastestmirror, product-id, search-disabled-repos, subscription-manager

This system is not registered with an entitlement server. You can use subscription-manager to register.

Loading mirror speeds from cached hostfile
Resolving Dependencies
--> Running transaction check
---> Package docker-compose-plugin.x86_64 0:2.27.1-1.el7 will be installed
--> Finished Dependency Resolution

Dependencies Resolved

=================================================================================================================================================================================================================
 Package                                                  Arch                                      Version                                            Repository                                           Size
=================================================================================================================================================================================================================
Installing:
 docker-compose-plugin                                    x86_64                                    2.27.1-1.el7                                       docker-ce-stable                                     13 M

Transaction Summary
=================================================================================================================================================================================================================
Install  1 Package

Total download size: 13 M
Installed size: 60 M
Is this ok [y/d/N]: y
Downloading packages:
Delta RPMs disabled because /usr/bin/applydeltarpm not installed.
warning: /var/cache/yum/x86_64/7/docker-ce-stable/packages/docker-compose-plugin-2.27.1-1.el7.x86_64.rpm: Header V4 RSA/SHA512 Signature, key ID 621e9f35: NOKEY=============- ] 835 kB/s |  13 MB  00:00:00 ETA 
Public key for docker-compose-plugin-2.27.1-1.el7.x86_64.rpm is not installed
docker-compose-plugin-2.27.1-1.el7.x86_64.rpm                                                                                                                                             |  13 MB  00:00:15     
Retrieving key from https://download.docker.com/linux/centos/gpg
Importing GPG key 0x621E9F35:
 Userid     : "Docker Release (CE rpm) <docker@docker.com>"
 Fingerprint: 060a 61c5 1b55 8a7f 742b 77aa c52f eb6b 621e 9f35
 From       : https://download.docker.com/linux/centos/gpg
Is this ok [y/N]: y
Running transaction check
Running transaction test
Transaction test succeeded
Running transaction
  Installing : docker-compose-plugin-2.27.1-1.el7.x86_64                                                                                                                                                     1/1 
  Verifying  : docker-compose-plugin-2.27.1-1.el7.x86_64                                                                                                                                                     1/1 

Installed:
  docker-compose-plugin.x86_64 0:2.27.1-1.el7                                                                                                                                                                    

Complete!
[root@node1 ~]# yum install docker-ce
Loaded plugins: fastestmirror, product-id, search-disabled-repos, subscription-manager

This system is not registered with an entitlement server. You can use subscription-manager to register.

Loading mirror speeds from cached hostfile
Resolving Dependencies
--> Running transaction check
---> Package docker-ce.x86_64 3:26.1.4-1.el7 will be installed
--> Processing Dependency: container-selinux >= 2:2.74 for package: 3:docker-ce-26.1.4-1.el7.x86_64
--> Processing Dependency: containerd.io >= 1.6.24 for package: 3:docker-ce-26.1.4-1.el7.x86_64
--> Processing Dependency: docker-ce-cli for package: 3:docker-ce-26.1.4-1.el7.x86_64
--> Processing Dependency: docker-ce-rootless-extras for package: 3:docker-ce-26.1.4-1.el7.x86_64
--> Running transaction check
---> Package container-selinux.noarch 2:2.119.2-1.911c772.el7_8 will be installed
---> Package containerd.io.x86_64 0:1.6.33-3.1.el7 will be installed
---> Package docker-ce-cli.x86_64 1:26.1.4-1.el7 will be installed
--> Processing Dependency: docker-buildx-plugin for package: 1:docker-ce-cli-26.1.4-1.el7.x86_64
---> Package docker-ce-rootless-extras.x86_64 0:26.1.4-1.el7 will be installed
--> Running transaction check
---> Package docker-buildx-plugin.x86_64 0:0.14.1-1.el7 will be installed
--> Finished Dependency Resolution

Dependencies Resolved

=================================================================================================================================================================================================================
 Package                                                  Arch                                  Version                                                    Repository                                       Size
=================================================================================================================================================================================================================
Installing:
 docker-ce                                                x86_64                                3:26.1.4-1.el7                                             docker-ce-stable                                 27 M
Installing for dependencies:
 container-selinux                                        noarch                                2:2.119.2-1.911c772.el7_8                                  extras                                           40 k
 containerd.io                                            x86_64                                1.6.33-3.1.el7                                             docker-ce-stable                                 35 M
 docker-buildx-plugin                                     x86_64                                0.14.1-1.el7                                               docker-ce-stable                                 14 M
 docker-ce-cli                                            x86_64                                1:26.1.4-1.el7                                             docker-ce-stable                                 15 M
 docker-ce-rootless-extras                                x86_64                                26.1.4-1.el7                                               docker-ce-stable                                9.4 M

Transaction Summary
=================================================================================================================================================================================================================
Install  1 Package (+5 Dependent packages)

Total size: 100 M
Installed size: 341 M
Is this ok [y/d/N]: y
Downloading packages:
Running transaction check
Running transaction test
Transaction test succeeded
Running transaction
  Installing : 2:container-selinux-2.119.2-1.911c772.el7_8.noarch                                                                                                                                            1/6 
  Installing : containerd.io-1.6.33-3.1.el7.x86_64                                                                                                                                                           2/6 
  Installing : docker-buildx-plugin-0.14.1-1.el7.x86_64                                                                                                                                                      3/6 
  Installing : 1:docker-ce-cli-26.1.4-1.el7.x86_64                                                                                                                                                           4/6 
  Installing : docker-ce-rootless-extras-26.1.4-1.el7.x86_64                                                                                                                                                 5/6 
  Installing : 3:docker-ce-26.1.4-1.el7.x86_64                                                                                                                                                               6/6 
  Verifying  : 2:container-selinux-2.119.2-1.911c772.el7_8.noarch                                                                                                                                            1/6 
  Verifying  : containerd.io-1.6.33-3.1.el7.x86_64                                                                                                                                                           2/6 
  Verifying  : 3:docker-ce-26.1.4-1.el7.x86_64                                                                                                                                                               3/6 
  Verifying  : 1:docker-ce-cli-26.1.4-1.el7.x86_64                                                                                                                                                           4/6 
  Verifying  : docker-ce-rootless-extras-26.1.4-1.el7.x86_64                                                                                                                                                 5/6 
  Verifying  : docker-buildx-plugin-0.14.1-1.el7.x86_64                                                                                                                                                      6/6 

Installed:
  docker-ce.x86_64 3:26.1.4-1.el7                                                                                                                                                                                

Dependency Installed:
  container-selinux.noarch 2:2.119.2-1.911c772.el7_8           containerd.io.x86_64 0:1.6.33-3.1.el7           docker-buildx-plugin.x86_64 0:0.14.1-1.el7           docker-ce-cli.x86_64 1:26.1.4-1.el7          
  docker-ce-rootless-extras.x86_64 0:26.1.4-1.el7             

Complete!
[root@node1 ~]# docker --version
Docker version 26.1.4, build 5650f9b
[root@node1 ~]# cd  /etc/docker
[root@node1 docker]# ll
total 8
-rw-r--r--. 1 root root 268 Nov  3 22:42 daemon.json.rpmsave
-rw-------. 1 root root 244 Nov  3 22:34 key.json
[root@node1 docker]# vim daemon.json
[root@node1 docker]# cat daemon.json
{
  
  "registry-mirrors": [
        "https://i3nc9nvv.mirror.aliyuncs.com", 
        "https://docker.m.daocloud.io",        
        "https://dockerhub.timeweb.cloud"    
    ]
 
  }
[root@node1 docker]# 
[root@node1 docker]# systemctl  restart docker
[root@node1 docker]# docker pull nginx
Using default tag: latest
latest: Pulling from library/nginx
38513bd72563: Pull complete 
a0a6ab141558: Pull complete 
0e86847a3920: Pull complete 
1bace2083289: Pull complete 
89df300a082a: Pull complete 
35fb9ffa6621: Pull complete 
5545b08f9d26: Pull complete 
Digest: sha256:f547e3d0d5d02f7009737b284abc87d808e4252b42dceea361811e9fc606287f
Status: Downloaded newer image for nginx:latest
docker.io/library/nginx:latest
[root@node1 docker]# 

```

![docker_11](/documents/img/ops/docker/basic/11.png)
![docker_12](/documents/img/ops/docker/basic/12.png)
![docker_13](/documents/img/ops/docker/basic/13.png)
![docker_14](/documents/img/ops/docker/basic/14.png)
![docker_15](/documents/img/ops/docker/basic/15.png)
![docker_16](/documents/img/ops/docker/basic/16.png)
![docker_17](/documents/img/ops/docker/basic/17.png)
![docker_18](/documents/img/ops/docker/basic/18.png)
![docker_19](/documents/img/ops/docker/basic/19.png)
![docker_20](/documents/img/ops/docker/basic/20.png)
![docker_21](/documents/img/ops/docker/basic/21.png)
![docker_22](/documents/img/ops/docker/basic/22.png)
![docker_23](/documents/img/ops/docker/basic/23.png)
![docker_24](/documents/img/ops/docker/basic/24.png)
![docker_25](/documents/img/ops/docker/basic/25.png)
![docker_26](/documents/img/ops/docker/basic/26.png)
![docker_27](/documents/img/ops/docker/basic/27.png)
![docker_28](/documents/img/ops/docker/basic/28.png)
![docker_29](/documents/img/ops/docker/basic/29.png)
![docker_30](/documents/img/ops/docker/basic/30.png)
![docker_31](/documents/img/ops/docker/basic/31.png)

## 构建镜像

![docker_01](/documents/img/ops/docker/basic/01.png)
![docker_02](/documents/img/ops/docker/basic/02.png)
![docker_03](/documents/img/ops/docker/basic/03.png)
![docker_04](/documents/img/ops/docker/basic/04.png)
![docker_05](/documents/img/ops/docker/basic/05.png)
![docker_06](/documents/img/ops/docker/basic/06.png)
![docker_07](/documents/img/ops/docker/basic/07.png)
![docker_08](/documents/img/ops/docker/basic/08.png)
![docker_09](/documents/img/ops/docker/basic/09.png)
![docker_10](/documents/img/ops/docker/basic/10.png)


```shell
Connecting to 192.168.230.129:22...
Connection established.
To escape to local shell, press 'Ctrl+Alt+]'.

WARNING! The remote SSH server rejected X11 forwarding request.
Last login: Tue Nov  4 20:33:38 2025
[root@node1 ~]# docker images
Cannot connect to the Docker daemon at unix:///var/run/docker.sock. Is the docker daemon running?
[root@node1 ~]# systemctl  restart docker
[root@node1 ~]# docker images
REPOSITORY   TAG       IMAGE ID       CREATED       SIZE
nginx        latest    9d0e6f6199dc   7 days ago    152MB
centos       7         eeb6ee3f44bd   4 years ago   204MB
[root@node1 ~]# mkdir /qianfeng
[root@node1 ~]# cd /qianfeng
[root@node1 qianfeng]# ll
total 0
[root@node1 qianfeng]# vim Dockerfile
[root@node1 qianfeng]# vim Dockerfile
[root@node1 qianfeng]# docker build -t qianfeng-os:v1 ./
[+] Building 1.2s (7/7) FINISHED                      docker:default
 => [internal] load build definition from Dockerfile            0.0s
 => => transferring dockerfile: 384B                            0.0s
 => [internal] load metadata for docker.io/library/centos:7     0.0s
 => [internal] load .dockerignore                               0.0s
 => => transferring context: 2B                                 0.0s
 => [1/4] FROM docker.io/library/centos:7                       0.0s
 => [2/4] WORKDIR /etc/yum.repos.d/                             0.0s
 => [3/4] RUN rm -rf *                                          0.5s
 => ERROR [4/4] RUN curl -o /etc/yum.repos.d/epel.repo https:/  0.6s
------                                                               
 > [4/4] RUN curl -o /etc/yum.repos.d/epel.repo https://mirrors.cloud.tencent.com/repo/epel-7.repo  && curl -o  /etc/yum.repos.d/CentOS-Base.repo https://mirrors.huaweicloud.com/repository/conf/CentOS-7-anon.repo && yum install -y net-tools:                                   
0.260   % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
0.260                                  Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--100   237  100   237    0     0    877      0 --:--:-- --:--:-- --:--:--   877
0.560 curl: (6) Could not resolve host:  ; Unknown error
------
Dockerfile:4
--------------------
   3 |     RUN rm -rf *
   4 | >>> RUN curl -o /etc/yum.repos.d/epel.repo https://mirrors.cloud.tencent.com/repo/epel-7.repo \ && curl -o  /etc/yum.repos.d/CentOS-Base.repo https://mirrors.huaweicloud.com/repository/conf/CentOS-7-anon.repo \
   5 | >>> && yum install -y net-tools
   6 |     
--------------------
ERROR: failed to solve: process "/bin/sh -c curl -o /etc/yum.repos.d/epel.repo https://mirrors.cloud.tencent.com/repo/epel-7.repo \\ && curl -o  /etc/yum.repos.d/CentOS-Base.repo https://mirrors.huaweicloud.com/repository/conf/CentOS-7-anon.repo && yum install -y net-tools" did not complete successfully: exit code: 6
[root@node1 qianfeng]# vim Dockerfile
[root@node1 qianfeng]# docker build -t qianfeng-os:v1 ./
[+] Building 69.1s (8/8) FINISHED                                                                                                                                                                 docker:default
 => [internal] load build definition from Dockerfile                                                                                                                                                        0.0s
 => => transferring dockerfile: 385B                                                                                                                                                                        0.0s
 => [internal] load metadata for docker.io/library/centos:7                                                                                                                                                 0.0s
 => [internal] load .dockerignore                                                                                                                                                                           0.0s
 => => transferring context: 2B                                                                                                                                                                             0.0s
 => [1/4] FROM docker.io/library/centos:7                                                                                                                                                                   0.0s
 => CACHED [2/4] WORKDIR /etc/yum.repos.d/                                                                                                                                                                  0.0s
 => CACHED [3/4] RUN rm -rf *                                                                                                                                                                               0.0s
 => [4/4] RUN curl -o /etc/yum.repos.d/epel.repo https://mirrors.cloud.tencent.com/repo/epel-7.repo  && curl -o  /etc/yum.repos.d/CentOS-Base.repo https://mirrors.huaweicloud.com/repository/conf/CentOS  67.2s
 => exporting to image                                                                                                                                                                                      1.8s 
 => => exporting layers                                                                                                                                                                                     1.8s 
 => => writing image sha256:041bd8c2f74650a0416ebd0649dd191b257f6b0bcb7f0ae0164b97138ba5f82d                                                                                                                0.0s 
 => => naming to docker.io/library/qianfeng-os:v1                                                                                                                                                           0.0s 
[root@node1 qianfeng]# docker images                                                                                                                                                                             
REPOSITORY    TAG       IMAGE ID       CREATED              SIZE                                                                                                                                                 
qianfeng-os   v1        041bd8c2f746   About a minute ago   503MB
nginx         latest    9d0e6f6199dc   7 days ago           152MB
centos        7         eeb6ee3f44bd   4 years ago          204MB
[root@node1 qianfeng]# cd ..
[root@node1 /]# ll
total 20
drwxr-xr-x.   2 root root   24 Nov  3 02:02 beijing
lrwxrwxrwx.   1 root root    7 Nov  2 03:33 bin -> usr/bin
dr-xr-xr-x.   5 root root 4096 Nov  2 03:40 boot
drwxr-xr-x.   2 root root   24 Nov  3 21:08 data
drwxr-xr-x.  20 root root 3240 Nov  4 20:32 dev
drwxr-xr-x.  82 root root 8192 Nov  4 20:32 etc
drwxr-xr-x.   3 root root   16 Nov  2 03:37 home
lrwxrwxrwx.   1 root root    7 Nov  2 03:33 lib -> usr/lib
lrwxrwxrwx.   1 root root    9 Nov  2 03:33 lib64 -> usr/lib64
drwxr-xr-x.   2 root root    6 Nov  5  2016 media
drwxr-xr-x.   2 root root    6 Nov  5  2016 mnt
drwxr-xr-x.   3 root root   24 Nov  3 22:57 opt
dr-xr-xr-x. 168 root root    0 Nov  4 20:32 proc
drwxr-xr-x.   2 root root   24 Nov  4 20:45 qianfeng
dr-xr-x---.   4 root root  178 Nov  4 20:45 root
drwxr-xr-x.  28 root root  840 Nov  4 20:44 run
lrwxrwxrwx.   1 root root    8 Nov  2 03:33 sbin -> usr/sbin
drwxr-xr-x.   2 root root   24 Nov  3 02:03 shanghai
drwxr-xr-x.   2 root root    6 Nov  5  2016 srv
dr-xr-xr-x.  13 root root    0 Nov  4 20:32 sys
drwxrwxrwt.  19 root root 4096 Nov  4 20:33 tmp
drwxr-xr-x.  13 root root  155 Nov  2 03:33 usr
drwxr-xr-x.  19 root root  267 Nov  2 03:39 var
[root@node1 /]# mkdir qianfeng2
[root@node1 /]# ll
total 20
drwxr-xr-x.   2 root root   24 Nov  3 02:02 beijing
lrwxrwxrwx.   1 root root    7 Nov  2 03:33 bin -> usr/bin
dr-xr-xr-x.   5 root root 4096 Nov  2 03:40 boot
drwxr-xr-x.   2 root root   24 Nov  3 21:08 data
drwxr-xr-x.  20 root root 3240 Nov  4 20:32 dev
drwxr-xr-x.  82 root root 8192 Nov  4 20:32 etc
drwxr-xr-x.   3 root root   16 Nov  2 03:37 home
lrwxrwxrwx.   1 root root    7 Nov  2 03:33 lib -> usr/lib
lrwxrwxrwx.   1 root root    9 Nov  2 03:33 lib64 -> usr/lib64
drwxr-xr-x.   2 root root    6 Nov  5  2016 media
drwxr-xr-x.   2 root root    6 Nov  5  2016 mnt
drwxr-xr-x.   3 root root   24 Nov  3 22:57 opt
dr-xr-xr-x. 168 root root    0 Nov  4 20:32 proc
drwxr-xr-x.   2 root root   24 Nov  4 20:45 qianfeng
drwxr-xr-x.   2 root root    6 Nov  4 20:49 qianfeng2
dr-xr-x---.   4 root root  178 Nov  4 20:45 root
drwxr-xr-x.  28 root root  840 Nov  4 20:44 run
lrwxrwxrwx.   1 root root    8 Nov  2 03:33 sbin -> usr/sbin
drwxr-xr-x.   2 root root   24 Nov  3 02:03 shanghai
drwxr-xr-x.   2 root root    6 Nov  5  2016 srv
dr-xr-xr-x.  13 root root    0 Nov  4 20:32 sys
drwxrwxrwt.  19 root root 4096 Nov  4 20:33 tmp
drwxr-xr-x.  13 root root  155 Nov  2 03:33 usr
drwxr-xr-x.  19 root root  267 Nov  2 03:39 var
[root@node1 /]# cat qianfeng/Dockerfile
FROM centos:7
WORKDIR /etc/yum.repos.d/
RUN rm -rf *
RUN curl -o /etc/yum.repos.d/epel.repo https://mirrors.cloud.tencent.com/repo/epel-7.repo \
 && curl -o  /etc/yum.repos.d/CentOS-Base.repo https://mirrors.huaweicloud.com/repository/conf/CentOS-7-anon.repo \
&& yum install -y net-tools
[root@node1 /]# cd qianfeng2
[root@node1 qianfeng2]# vim Dockerfile
[root@node1 qianfeng2]# vim Dockerfile
[root@node1 qianfeng2]# docker build -t qianfeng-os:v2 ./
[+] Building 0.1s (5/5) FINISHED                                                                                                                                                                  docker:default
 => [internal] load build definition from Dockerfile                                                                                                                                                        0.0s
 => => transferring dockerfile: 114B                                                                                                                                                                        0.0s
 => [internal] load metadata for docker.io/library/qianfeng-os:v1                                                                                                                                           0.0s
 => [internal] load .dockerignore                                                                                                                                                                           0.0s
 => => transferring context: 2B                                                                                                                                                                             0.0s
 => [1/1] FROM docker.io/library/qianfeng-os:v1                                                                                                                                                             0.0s
 => exporting to image                                                                                                                                                                                      0.0s
 => => exporting layers                                                                                                                                                                                     0.0s
 => => writing image sha256:041bd8c2f74650a0416ebd0649dd191b257f6b0bcb7f0ae0164b97138ba5f82d                                                                                                                0.0s
 => => naming to docker.io/library/qianfeng-os:v2                                                                                                                                                           0.0s
[root@node1 qianfeng2]# docker images
REPOSITORY    TAG       IMAGE ID       CREATED         SIZE
qianfeng-os   v1        041bd8c2f746   4 minutes ago   503MB
qianfeng-os   v2        041bd8c2f746   4 minutes ago   503MB
nginx         latest    9d0e6f6199dc   7 days ago      152MB
centos        7         eeb6ee3f44bd   4 years ago     204MB
[root@node1 qianfeng2]# docker run --name test2 -it qianfeng-os:v2 bash
[root@e737d0e06757 yum.repos.d]# ifconfig
eth0: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
        inet 172.17.0.2  netmask 255.255.0.0  broadcast 172.17.255.255
        ether 02:42:ac:11:00:02  txqueuelen 0  (Ethernet)
        RX packets 8  bytes 648 (648.0 B)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 0  bytes 0 (0.0 B)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

lo: flags=73<UP,LOOPBACK,RUNNING>  mtu 65536
        inet 127.0.0.1  netmask 255.0.0.0
        inet6 ::1  prefixlen 128  scopeid 0x10<host>
        loop  txqueuelen 1  (Local Loopback)
        RX packets 0  bytes 0 (0.0 B)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 0  bytes 0 (0.0 B)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

[root@e737d0e06757 yum.repos.d]# docker ps
bash: docker: command not found
[root@e737d0e06757 yum.repos.d]# ip -a
bash: ip: command not found
[root@e737d0e06757 yum.repos.d]# ip
bash: ip: command not found
[root@e737d0e06757 yum.repos.d]# ifconfig
eth0: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
        inet 172.17.0.2  netmask 255.255.0.0  broadcast 172.17.255.255
        ether 02:42:ac:11:00:02  txqueuelen 0  (Ethernet)
        RX packets 8  bytes 648 (648.0 B)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 0  bytes 0 (0.0 B)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

lo: flags=73<UP,LOOPBACK,RUNNING>  mtu 65536
        inet 127.0.0.1  netmask 255.0.0.0
        inet6 ::1  prefixlen 128  scopeid 0x10<host>
        loop  txqueuelen 1  (Local Loopback)
        RX packets 0  bytes 0 (0.0 B)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 0  bytes 0 (0.0 B)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

[root@e737d0e06757 yum.repos.d]# ip -s
bash: ip: command not found
[root@e737d0e06757 yum.repos.d]# ip addr show
bash: ip: command not found
[root@e737d0e06757 yum.repos.d]# exit
exit
[root@node1 qianfeng2]# docker ps
CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES
[root@node1 qianfeng2]# docker images
REPOSITORY    TAG       IMAGE ID       CREATED         SIZE
qianfeng-os   v1        041bd8c2f746   9 minutes ago   503MB
qianfeng-os   v2        041bd8c2f746   9 minutes ago   503MB
nginx         latest    9d0e6f6199dc   7 days ago      152MB
centos        7         eeb6ee3f44bd   4 years ago     204MB
[root@node1 qianfeng2]# 

```

```shell
[root@node1 qianfeng2]# yum install wget
Loaded plugins: fastestmirror, product-id, search-disabled-repos, subscription-manager

This system is not registered with an entitlement server. You can use subscription-manager to register.

base                                                                                                                                                                                      | 3.6 kB  00:00:00     
docker-ce-stable                                                                                                                                                                          | 3.5 kB  00:00:00     
epel                                                                                                                                                                                      | 4.3 kB  00:00:00     
extras                                                                                                                                                                                    | 2.9 kB  00:00:00     
updates                                                                                                                                                                                   | 2.9 kB  00:00:00     
Loading mirror speeds from cached hostfile
Resolving Dependencies
--> Running transaction check
---> Package wget.x86_64 0:1.14-18.el7_6.1 will be installed
--> Finished Dependency Resolution

Dependencies Resolved

=================================================================================================================================================================================================================
 Package                                        Arch                                             Version                                                    Repository                                      Size
=================================================================================================================================================================================================================
Installing:
 wget                                           x86_64                                           1.14-18.el7_6.1                                            base                                           547 k

Transaction Summary
=================================================================================================================================================================================================================
Install  1 Package

Total download size: 547 k
Installed size: 2.0 M
Is this ok [y/d/N]: y
Downloading packages:
wget-1.14-18.el7_6.1.x86_64.rpm                                                                                                                                                           | 547 kB  00:00:00     
Running transaction check
Running transaction test
Transaction test succeeded
Running transaction
  Installing : wget-1.14-18.el7_6.1.x86_64                                                                                                                                                                   1/1 
  Verifying  : wget-1.14-18.el7_6.1.x86_64                                                                                                                                                                   1/1 

Installed:
  wget.x86_64 0:1.14-18.el7_6.1                                                                                                                                                                                  

Complete!
[root@node1 qianfeng2]# ll
total 4
-rw-r--r--. 1 root root   0 Nov  4 21:00 1.txt
-rw-r--r--. 1 root root 130 Nov  4 21:58 Dockerfile
[root@node1 qianfeng2]# wget https://nginx.org/download/nginx-1.12.2.tar.gz
--2025-11-04 22:03:48--  https://nginx.org/download/nginx-1.12.2.tar.gz
Resolving nginx.org (nginx.org)... 3.125.197.172, 52.58.199.22, 2a05:d014:5c0:2600::6, ...
Connecting to nginx.org (nginx.org)|3.125.197.172|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 981687 (959K) [application/octet-stream]
Saving to: ‘nginx-1.12.2.tar.gz’

100%[=======================================================================================================================================================================>] 981,687     1.27MB/s   in 0.7s   

2025-11-04 22:03:49 (1.27 MB/s) - ‘nginx-1.12.2.tar.gz’ saved [981687/981687]

[root@node1 qianfeng2]# ll
total 964
-rw-r--r--. 1 root root      0 Nov  4 21:00 1.txt
-rw-r--r--. 1 root root    130 Nov  4 21:58 Dockerfile
-rw-r--r--. 1 root root 981687 Oct 17  2017 nginx-1.12.2.tar.gz
[root@node1 qianfeng2]# docker build -t qianfeng-os:v2 ./
[+] Building 0.5s (8/8) FINISHED                                                                                                                                                                  docker:default
 => [internal] load build definition from Dockerfile                                                                                                                                                        0.0s
 => => transferring dockerfile: 226B                                                                                                                                                                        0.0s
 => [internal] load metadata for docker.io/library/qianfeng-os:v1                                                                                                                                           0.0s
 => [internal] load .dockerignore                                                                                                                                                                           0.0s
 => => transferring context: 2B                                                                                                                                                                             0.0s
 => CACHED [1/4] FROM docker.io/library/qianfeng-os:v1                                                                                                                                                      0.0s
 => [internal] load build context                                                                                                                                                                           0.1s
 => => transferring context: 982.11kB                                                                                                                                                                       0.0s
 => [2/4] COPY ./1.txt /var/                                                                                                                                                                                0.0s
 => [3/4] ADD ./nginx-1.12.2.tar.gz /tmp/                                                                                                                                                                   0.2s
 => exporting to image                                                                                                                                                                                      0.1s
 => => exporting layers                                                                                                                                                                                     0.1s
 => => writing image sha256:cad401089f2dde9fa2acf6a1fffd0975a7f4b3677c3965e4dafba0e44b1cb5e4                                                                                                                0.0s
 => => naming to docker.io/library/qianfeng-os:v2                                                                                                                                                           0.0s
[root@node1 qianfeng2]# docker run --name test2 -it qianfeng-os:v2 bash
docker: Error response from daemon: Conflict. The container name "/test2" is already in use by container "e737d0e06757172b5cd5f86dc22689fae524499e5d72d1ff5b3bfca8e515a591". You have to remove (or rename) that container to be able to reuse that name.
See 'docker run --help'.
[root@node1 qianfeng2]# docker run --name test3 -it qianfeng-os:v2 bash
ls: cannot access bash: No such file or directory
[root@node1 qianfeng2]# docker images
REPOSITORY    TAG       IMAGE ID       CREATED              SIZE
qianfeng-os   v2        cad401089f2d   About a minute ago   509MB
qianfeng-os   v1        041bd8c2f746   About an hour ago    503MB
nginx         latest    9d0e6f6199dc   7 days ago           152MB
centos        7         eeb6ee3f44bd   4 years ago          204MB
[root@node1 qianfeng2]# docker run --name test3 -it qianfeng-os:v2
docker: Error response from daemon: Conflict. The container name "/test3" is already in use by container "0d9b9f0c2be5cd25b86d12988113da85b1018faf224580bdfbc2c3487be70a95". You have to remove (or rename) that container to be able to reuse that name.
See 'docker run --help'.
[root@node1 qianfeng2]# docker ps
CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES
[root@node1 qianfeng2]# docker run --name test4 -it qianfeng-os:v2
total 12
-rw-r--r--.   1 root root 12114 Nov 13  2020 anaconda-post.log
lrwxrwxrwx.   1 root root     7 Nov 13  2020 bin -> usr/bin
drwxr-xr-x.   5 root root   360 Nov  5 03:07 dev
drwxr-xr-x.   1 root root    66 Nov  5 03:07 etc
drwxr-xr-x.   2 root root     6 Apr 11  2018 home
lrwxrwxrwx.   1 root root     7 Nov 13  2020 lib -> usr/lib
lrwxrwxrwx.   1 root root     9 Nov 13  2020 lib64 -> usr/lib64
drwxr-xr-x.   2 root root     6 Apr 11  2018 media
drwxr-xr-x.   2 root root     6 Apr 11  2018 mnt
drwxr-xr-x.   2 root root     6 Apr 11  2018 opt
dr-xr-xr-x. 172 root root     0 Nov  5 03:07 proc
dr-xr-x---.   1 root root    18 Nov  5 01:45 root
drwxr-xr-x.   1 root root     6 Nov  5 01:46 run
lrwxrwxrwx.   1 root root     8 Nov 13  2020 sbin -> usr/sbin
drwxr-xr-x.   2 root root     6 Apr 11  2018 srv
dr-xr-xr-x.  13 root root     0 Nov  5 01:32 sys
drwxrwxrwt.   1 root root    26 Nov  5 03:04 tmp
drwxr-xr-x.   1 root root    40 Nov 13  2020 usr
drwxr-xr-x.   1 root root    19 Nov  5 03:04 var
[root@node1 qianfeng2]# ls -a
.  ..  1.txt  Dockerfile  nginx-1.12.2.tar.gz
[root@node1 qianfeng2]# ls
1.txt  Dockerfile  nginx-1.12.2.tar.gz
[root@node1 qianfeng2]# cat Dockerfile
FROM qianfeng-os:v1

COPY ./1.txt /var/
ADD ./nginx-1.12.2.tar.gz /tmp/
ENV MYPATH=/
WORKDIR $MYPATH
ENTRYPOINT ["ls"]
CMD ["-l"]
[root@node1 qianfeng2]# docker run --name test4 -it qianfeng-os:v2 bash
docker: Error response from daemon: Conflict. The container name "/test4" is already in use by container "4c3e89190bd8f16c920a8eb111e399b6ef4f1e982d740b3eb6cff73e2cf1914e". You have to remove (or rename) that container to be able to reuse that name.
See 'docker run --help'.
[root@node1 qianfeng2]# docker stop test4
test4
[root@node1 qianfeng2]# docker stop test3
test3
[root@node1 qianfeng2]# docker stop test2
test2
[root@node1 qianfeng2]# docker rm test4
test4
[root@node1 qianfeng2]# docker rm test3
test3
[root@node1 qianfeng2]# docker rm test2
test2
[root@node1 qianfeng2]# docker images
REPOSITORY    TAG       IMAGE ID       CREATED             SIZE
qianfeng-os   v2        cad401089f2d   9 minutes ago       509MB
qianfeng-os   v1        041bd8c2f746   About an hour ago   503MB
nginx         latest    9d0e6f6199dc   7 days ago          152MB
centos        7         eeb6ee3f44bd   4 years ago         204MB
[root@node1 qianfeng2]# docker ps
CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES
[root@node1 qianfeng2]# docker run --name test2 -it qianfeng-os:v2 bash
ls: cannot access bash: No such file or directory
[root@node1 qianfeng2]# docker stop test2
test2
[root@node1 qianfeng2]# docker rm test2
test2
[root@node1 qianfeng2]# vim Dockerfile
[root@node1 qianfeng2]# docker images
REPOSITORY    TAG       IMAGE ID       CREATED          SIZE
qianfeng-os   v2        cad401089f2d   12 minutes ago   509MB
qianfeng-os   v1        041bd8c2f746   2 hours ago      503MB
nginx         latest    9d0e6f6199dc   7 days ago       152MB
centos        7         eeb6ee3f44bd   4 years ago      204MB
[root@node1 qianfeng2]# docker rmi qianfeng-os:v2
Untagged: qianfeng-os:v2
Deleted: sha256:cad401089f2dde9fa2acf6a1fffd0975a7f4b3677c3965e4dafba0e44b1cb5e4
[root@node1 qianfeng2]# docker images
REPOSITORY    TAG       IMAGE ID       CREATED       SIZE
qianfeng-os   v1        041bd8c2f746   2 hours ago   503MB
nginx         latest    9d0e6f6199dc   7 days ago    152MB
centos        7         eeb6ee3f44bd   4 years ago   204MB
[root@node1 qianfeng2]# docker build -t qianfeng-os:v2 ./
[+] Building 0.1s (8/8) FINISHED                                                                                                                                                                  docker:default
 => [internal] load build definition from Dockerfile                                                                                                                                                        0.0s
 => => transferring dockerfile: 230B                                                                                                                                                                        0.0s
 => [internal] load metadata for docker.io/library/qianfeng-os:v1                                                                                                                                           0.0s
 => [internal] load .dockerignore                                                                                                                                                                           0.0s
 => => transferring context: 2B                                                                                                                                                                             0.0s
 => [1/3] FROM docker.io/library/qianfeng-os:v1                                                                                                                                                             0.0s
 => [internal] load build context                                                                                                                                                                           0.0s
 => => transferring context: 178B                                                                                                                                                                           0.0s
 => CACHED [2/3] COPY ./1.txt /var/                                                                                                                                                                         0.0s
 => CACHED [3/3] ADD ./nginx-1.12.2.tar.gz /tmp/                                                                                                                                                            0.0s
 => exporting to image                                                                                                                                                                                      0.0s
 => => exporting layers                                                                                                                                                                                     0.0s
 => => writing image sha256:966e7841919d01a268c9ee5d80f82a039444b6ca195ebf7c21eb36ab8f0bb460                                                                                                                0.0s
 => => naming to docker.io/library/qianfeng-os:v2                                                                                                                                                           0.0s
[root@node1 qianfeng2]# docker run --name test2 -it qianfeng-os:v2 bash
[root@fd098f7b0693 yum.repos.d]# cd /var
[root@fd098f7b0693 var]# ll
total 0
-rw-r--r--. 1 root root  0 Nov  5 02:00 1.txt
drwxr-xr-x. 2 root root  6 Apr 11  2018 adm
drwxr-xr-x. 1 root root 17 Nov 13  2020 cache
drwxr-xr-x. 2 root root 22 Nov 13  2020 db
drwxr-xr-x. 2 root root  6 Apr 11  2018 empty
drwxr-xr-x. 2 root root  6 Apr 11  2018 games
drwxr-xr-x. 2 root root  6 Apr 11  2018 gopher
drwxr-xr-x. 3 root root 18 Nov 13  2020 kerberos
drwxr-xr-x. 1 root root 28 Nov 13  2020 lib
drwxr-xr-x. 2 root root  6 Apr 11  2018 local
lrwxrwxrwx. 1 root root 11 Nov 13  2020 lock -> ../run/lock
drwxr-xr-x. 1 root root 21 Nov 13  2020 log
lrwxrwxrwx. 1 root root 10 Nov 13  2020 mail -> spool/mail
drwxr-xr-x. 2 root root  6 Apr 11  2018 nis
drwxr-xr-x. 2 root root  6 Apr 11  2018 opt
drwxr-xr-x. 2 root root  6 Apr 11  2018 preserve
lrwxrwxrwx. 1 root root  6 Nov 13  2020 run -> ../run
drwxr-xr-x. 4 root root 29 Nov 13  2020 spool
drwxrwxrwt. 1 root root  6 Nov  5 01:46 tmp
drwxr-xr-x. 2 root root  6 Apr 11  2018 yp
[root@fd098f7b0693 var]# cd /tmp
[root@fd098f7b0693 tmp]# ll
total 4
-rwx------. 1 root root 836 Nov 13  2020 ks-script-DrRL8A
drwxr-xr-x. 8 1001 1001 158 Oct 17  2017 nginx-1.12.2
-rw-------. 1 root root   0 Nov 13  2020 yum.log
[root@fd098f7b0693 tmp]# cd nginx-1.12.2
[root@fd098f7b0693 nginx-1.12.2]# ll
total 704
-rw-r--r--. 1 1001 1001 278202 Oct 17  2017 CHANGES
-rw-r--r--. 1 1001 1001 423948 Oct 17  2017 CHANGES.ru
-rw-r--r--. 1 1001 1001   1397 Oct 17  2017 LICENSE
-rw-r--r--. 1 1001 1001     49 Oct 17  2017 README
drwxr-xr-x. 6 1001 1001   4096 Oct 17  2017 auto
drwxr-xr-x. 2 1001 1001    168 Oct 17  2017 conf
-rwxr-xr-x. 1 1001 1001   2481 Oct 17  2017 configure
drwxr-xr-x. 4 1001 1001     72 Oct 17  2017 contrib
drwxr-xr-x. 2 1001 1001     40 Oct 17  2017 html
drwxr-xr-x. 2 1001 1001     21 Oct 17  2017 man
drwxr-xr-x. 9 1001 1001     91 Oct 17  2017 src
[root@fd098f7b0693 nginx-1.12.2]# 

[root@fd098f7b0693 nginx-1.12.2]# exit
exit
[root@node1 qianfeng2]# ll
total 964
-rw-r--r--. 1 root root      0 Nov  4 21:00 1.txt
-rw-r--r--. 1 root root    134 Nov  4 22:16 Dockerfile
-rw-r--r--. 1 root root 981687 Oct 17  2017 nginx-1.12.2.tar.gz
[root@node1 qianfeng2]# systemctl enable docker
Created symlink from /etc/systemd/system/multi-user.target.wants/docker.service to /usr/lib/systemd/system/docker.service.
[root@node1 qianfeng2]# docker stop test2
test2
[root@node1 qianfeng2]# docker rm test2
test2
[root@node1 qianfeng2]# docker rmi qianfeng-os:v2
Untagged: qianfeng-os:v2
Deleted: sha256:966e7841919d01a268c9ee5d80f82a039444b6ca195ebf7c21eb36ab8f0bb460
[root@node1 qianfeng2]# docker images
REPOSITORY    TAG       IMAGE ID       CREATED       SIZE
qianfeng-os   v1        041bd8c2f746   2 hours ago   503MB
nginx         latest    9d0e6f6199dc   7 days ago    152MB
centos        7         eeb6ee3f44bd   4 years ago   204MB
[root@node1 qianfeng2]# docker ps
CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES
[root@node1 qianfeng2]# 

```

